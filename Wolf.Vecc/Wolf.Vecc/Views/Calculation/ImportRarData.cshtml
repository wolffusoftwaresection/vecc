@{
    Layout = null;
}
@model Wolf.Vecc.Model.ViewModel.CalculationModel
<!DOCTYPE html>
<!-- release v5.0.3, copyright 2014 - 2019 Kartik Visweswaran -->
<!--suppress JSUnresolvedLibraryURL -->
<html lang="en">
<head>

    <meta charset="UTF-8" />
    <title>Krajee JQuery Plugins - &copy; Kartik</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" crossorigin="anonymous">
    <link href="~/AdminLTE/css/fileinput.css" media="all" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" crossorigin="anonymous">
    <link href="~/AdminLTE/themes/explorer-fas/theme.css" media="all" rel="stylesheet" type="text/css" />
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script src="~/AdminLTE/js/plugins/piexif.js" type="text/javascript"></script>
    <script src="~/AdminLTE/js/plugins/sortable.js" type="text/javascript"></script>
    <script src="~/AdminLTE/js/fileinput.js" type="text/javascript"></script>
    <script src="~/AdminLTE/js/locales/fr.js" type="text/javascript"></script>
    <script src="~/AdminLTE/js/locales/es.js" type="text/javascript"></script>
    <script src="~/AdminLTE/themes/fas/theme.js" type="text/javascript"></script>
    <script src="~/AdminLTE/themes/explorer-fas/theme.js" type="text/javascript"></script>
</head>
<body>
    <div class="container my-4">
        <form enctype="multipart/form-data" method="post">
            @Html.HiddenFor(m => Model.Id)
            @Html.HiddenFor(m => Model.MaxPower)
            @Html.HiddenFor(m => Model.MaxQuality)
            @Html.HiddenFor(m => Model.MaxRefTorque)
            @Html.HiddenFor(m => Model.Nox)
            @Html.HiddenFor(m => Model.PemsFactory)
            @Html.HiddenFor(m => Model.PercentageLoad)
            @Html.HiddenFor(m => Model.VehicleModel)
            @Html.HiddenFor(m => Model.VehicleQuality)
            @Html.HiddenFor(m => Model.VehicleType)
            @Html.HiddenFor(m => Model.WhtcPower)
            <div class="form-group">
                <div class="file-loading">
                    <input id="uploadRar" data-show-preview="true" name="FilesInput" type="file" accept=".rar,.zip,.7z" />
                    @*<input type="file" data-show-preview="false" class="file" id="uploadRar" accept=".rar,.zip,.7z" data-theme="fas">*@
                </div>
                <div id="errorBlock" class="help-block"></div>
            </div>
        </form>
    </div>
</body>
</html>
<script>
    $(function () {
        $('#uploadRar').fileinput({
            uploadUrl: '/Calculation/ImportDataing',
            allowedFileExtensions: ['rar', 'zip', '7z'],
            maxFileSize: 800 * 1000, // 500Mb
            uploadExtraData: function () {//向后台传递参数
                var calculationModel = {
                    Id: $("#Id").val(),
                    VehicleModel: $("#VehicleModel").val(),
                    PemsFactory: $("#PemsFactory").val(),
                    VehicleType: $("#VehicleType").val(),
                    WhtcPower: $("#WhtcPower").val(),
                    VehicleQuality: $("#VehicleQuality").val(),
                    MaxRefTorque: $("#MaxRefTorque").val(),
                    MaxQuality: $("#MaxQuality").val(),
                    PercentageLoad: $("#PercentageLoad").val(),
                    MaxPower: $("#MaxPower").val(),
                    Nox: $("#Nox").val(),
                }
                return calculationModel;
            }
        }).on('filepreupload', function (event, data, previewId, index) {     //上传中
            console.log('文件正在上传');
        });
        $('#uploadRar').on("fileuploaded", function (event, data, previewId, index) {    //一个文件上传成功
            $("#uploadRar").fileinput('refresh');
            console.log('文件上传成功！');
        });
        $('#uploadRar').on('fileerror', function (event, data, msg) {  //一个文件上传失败
            console.log('文件上传失败！');
        });
    });
</script>